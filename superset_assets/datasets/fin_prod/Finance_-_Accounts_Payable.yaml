table_name: Finance - Accounts Payable
main_dttm_col: posting_date
description: null
default_endpoint: null
offset: 0
cache_timeout: null
schema: e8de4cea0e977e63
sql: "SELECT \n    SUM(gle.credit) AS invoiced_amount, \n    gle.company, \n    gle.voucher_type\
  \ AS group_column_type,\n\n    SUM(IF(gle.voucher_type = 'Purchase Invoice' AND\
  \ gle.debit > 0, gle.debit, 0)) AS debit_note_amount, \n\n    SUM(IF(gle.voucher_type\
  \ != 'Purchase Invoice' AND gle.against_voucher IS NULL AND gle.debit > 0, gle.debit,\
  \ 0)) AS unallocated_payment_amount, \n\n    SUM(IF(gle.voucher_type != 'Purchase\
  \ Invoice' AND gle.against_voucher IS NOT NULL AND gle.debit > 0, gle.debit, 0))\
  \ AS allocated_payment_amount,\n\n    IF(gle.against_voucher IS NULL, gle.voucher_type,\
  \ gle.against_voucher_type) AS real_voucher_type, \n\n    IF(gle.against_voucher\
  \ IS NULL, gle.voucher_no, gle.against_voucher) AS real_voucher_number,\n\n    gle.party_type,\
  \ \n    gle.party, \n    gle.posting_date,\n    gle.cost_center, \n    pi.due_date\
  \ as due_date,\n    gle.account_currency AS currency, \n    SUM(gle.credit_in_account_currency)\
  \ AS invoice_amount_in_account_currency,\n\n    GROUP_CONCAT(DISTINCT gle.project\
  \ SEPARATOR ', ') AS project, \n    gle.voucher_type, \n    gle.voucher_no,\n  \
  \  pi.supplier as supplier,\n    -- c.customer_group as customer_group,\n    --\
  \ st.sales_person as sales,\n    -- pt.credit_days,\n    (SUM(gle.credit) - \n \
  \   SUM(IF(gle.voucher_type = 'Purchase Invoice' AND gle.debit > 0, gle.debit, 0))\
  \ - \n    SUM(IF(gle.voucher_type != 'Purchase Invoice' AND gle.against_voucher\
  \ IS NULL AND gle.debit > 0, gle.debit, 0)) - \n    SUM(IF(gle.voucher_type != 'Purchase\
  \ Invoice' AND gle.against_voucher IS NOT NULL AND gle.debit > 0, gle.debit, 0)))\
  \ AS net_os,\n    \n    CASE \n        WHEN DATEDIFF(CURDATE(), gle.posting_date)\
  \ BETWEEN 0 AND 30 THEN '0-30'\n        WHEN DATEDIFF(CURDATE(), gle.posting_date)\
  \ BETWEEN 31 AND 60 THEN '31-60'\n        WHEN DATEDIFF(CURDATE(), gle.posting_date)\
  \ BETWEEN 61 AND 90 THEN '61-90'\n        WHEN DATEDIFF(CURDATE(), gle.posting_date)\
  \ BETWEEN 91 AND 120 THEN '91-120'\n        ELSE '120+'\n    END AS aging_bucket\n\
  \nFROM \n    {{ url_param('fin_database') or '5aaf8046cbf6fb75' }}.`tabGL Entry`\
  \ gle\nLEFT JOIN {{ url_param('fin_database') or '5aaf8046cbf6fb75' }}.`tabPurchase\
  \ Invoice` pi ON gle.voucher_no = pi.name\nLEFT JOIN {{ url_param('fin_database')\
  \ or '5aaf8046cbf6fb75' }}.`tabSupplier` s ON pi.supplier = s.name\n\n\nWHERE \n\
  \    gle.party_type = 'Supplier' and 'Purchase Invoice' in {% if url_param('allowed_doctypes')\
  \ %}\n{{ parse_url_param(url_param('allowed_doctypes')) }}\n{% else %} ('Purchase\
  \ Invoice') {% endif %}\nand\npi.cost_center in{% if url_param('allowed_cost_centers')\
  \ %} \n{{ parse_url_param(url_param('allowed_cost_centers')) }}\n{% else %}\n(pi.cost_center)\n\
  {% endif %}\n\nGROUP BY \n    real_voucher_type, \n    real_voucher_number, \n \
  \   gle.party\n\nHAVING \n    invoiced_amount != debit_note_amount + unallocated_payment_amount\
  \ + allocated_payment_amount\n"
params: null
template_params: null
filter_select_enabled: true
fetch_values_predicate: null
extra: null
normalize_columns: false
always_filter_main_dttm: false
uuid: f5bead0e-a014-48fa-80b2-86e1403f8380
metrics:
- metric_name: Overdue %
  verbose_name: ''
  metric_type: null
  expression: "(SUM(CASE \n        WHEN due_date <= CURRENT_DATE \n        THEN (invoiced_amount\
    \ - debit_note_amount - allocated_payment_amount - unallocated_payment_amount)\n\
    \        ELSE 0 \n    END) / SUM(net_os))*100"
  description: null
  d3format: null
  currency: null
  extra:
    warning_markdown: ''
  warning_text: null
- metric_name: DPO - 30 Days
  verbose_name: ''
  metric_type: null
  expression: ' (SUM(net_os) / SUM(invoiced_amount)) * 30'
  description: null
  d3format: null
  currency: null
  extra:
    warning_markdown: ''
  warning_text: null
- metric_name: Payable Net O/S
  verbose_name: ''
  metric_type: null
  expression: SUM(invoiced_amount-debit_note_amount - allocated_payment_amount-unallocated_payment_amount)
  description: null
  d3format: null
  currency: null
  extra:
    warning_markdown: ''
  warning_text: null
- metric_name: count
  verbose_name: COUNT(*)
  metric_type: count
  expression: COUNT(*)
  description: null
  d3format: null
  currency: null
  extra:
    warning_markdown: ''
  warning_text: null
columns:
- column_name: O/S Within Due
  verbose_name: null
  is_dttm: false
  is_active: true
  type: null
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: "CASE \n    WHEN CURDATE() <= due_date THEN net_os\n    ELSE 0\nEND"
  description: null
  python_date_format: null
  extra:
    warning_markdown: null
- column_name: Overdue Amount
  verbose_name: null
  is_dttm: false
  is_active: true
  type: null
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: "CASE \n    WHEN CURDATE() > due_date THEN net_os\n    ELSE 0\nEND"
  description: null
  python_date_format: null
  extra:
    warning_markdown: null
- column_name: Payable Net O/S
  verbose_name: null
  is_dttm: false
  is_active: true
  type: null
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: SUM(invoiced_amount-debit_note_amount - allocated_payment_amount-unallocated_payment_amount)
  description: null
  python_date_format: null
  extra:
    warning_markdown: null
- column_name: invoice_amount_in_account_currency
  verbose_name: null
  is_dttm: false
  is_active: true
  type: NEWDECIMAL
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: null
  description: null
  python_date_format: null
  extra:
    warning_markdown: null
- column_name: unallocated_payment_amount
  verbose_name: null
  is_dttm: false
  is_active: true
  type: NEWDECIMAL
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: null
  description: null
  python_date_format: null
  extra:
    warning_markdown: null
- column_name: allocated_payment_amount
  verbose_name: null
  is_dttm: false
  is_active: true
  type: NEWDECIMAL
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: null
  description: null
  python_date_format: null
  extra:
    warning_markdown: null
- column_name: debit_note_amount
  verbose_name: null
  is_dttm: false
  is_active: true
  type: NEWDECIMAL
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: null
  description: null
  python_date_format: null
  extra:
    warning_markdown: null
- column_name: invoiced_amount
  verbose_name: null
  is_dttm: false
  is_active: true
  type: NEWDECIMAL
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: null
  description: null
  python_date_format: null
  extra:
    warning_markdown: null
- column_name: net_os
  verbose_name: null
  is_dttm: false
  is_active: true
  type: NEWDECIMAL
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: null
  description: null
  python_date_format: null
  extra:
    warning_markdown: null
- column_name: due_date
  verbose_name: null
  is_dttm: true
  is_active: true
  type: DATE
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: null
  description: null
  python_date_format: null
  extra:
    warning_markdown: null
- column_name: posting_date
  verbose_name: null
  is_dttm: true
  is_active: true
  type: DATE
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: null
  description: null
  python_date_format: null
  extra:
    warning_markdown: null
- column_name: real_voucher_number
  verbose_name: null
  is_dttm: false
  is_active: true
  type: VAR_STRING
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: null
  description: null
  python_date_format: null
  extra:
    warning_markdown: null
- column_name: real_voucher_type
  verbose_name: null
  is_dttm: false
  is_active: true
  type: VAR_STRING
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: null
  description: null
  python_date_format: null
  extra:
    warning_markdown: null
- column_name: group_column_type
  verbose_name: null
  is_dttm: false
  is_active: true
  type: VAR_STRING
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: null
  description: null
  python_date_format: null
  extra:
    warning_markdown: null
- column_name: aging_bucket
  verbose_name: null
  is_dttm: false
  is_active: true
  type: VAR_STRING
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: null
  description: null
  python_date_format: null
  extra:
    warning_markdown: null
- column_name: party_type
  verbose_name: null
  is_dttm: false
  is_active: true
  type: VAR_STRING
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: null
  description: null
  python_date_format: null
  extra:
    warning_markdown: null
- column_name: cost_center
  verbose_name: null
  is_dttm: false
  is_active: true
  type: VAR_STRING
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: null
  description: null
  python_date_format: null
  extra:
    warning_markdown: null
- column_name: voucher_type
  verbose_name: null
  is_dttm: false
  is_active: true
  type: VAR_STRING
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: null
  description: null
  python_date_format: null
  extra:
    warning_markdown: null
- column_name: voucher_no
  verbose_name: null
  is_dttm: false
  is_active: true
  type: VAR_STRING
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: null
  description: null
  python_date_format: null
  extra:
    warning_markdown: null
- column_name: company
  verbose_name: null
  is_dttm: false
  is_active: true
  type: VAR_STRING
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: null
  description: null
  python_date_format: null
  extra:
    warning_markdown: null
- column_name: party
  verbose_name: null
  is_dttm: false
  is_active: true
  type: VAR_STRING
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: null
  description: null
  python_date_format: null
  extra:
    warning_markdown: null
- column_name: currency
  verbose_name: null
  is_dttm: false
  is_active: true
  type: VAR_STRING
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: null
  description: null
  python_date_format: null
  extra:
    warning_markdown: null
- column_name: supplier
  verbose_name: null
  is_dttm: false
  is_active: true
  type: VAR_STRING
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: null
  description: null
  python_date_format: null
  extra:
    warning_markdown: null
- column_name: project
  verbose_name: null
  is_dttm: false
  is_active: true
  type: BLOB
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: null
  description: null
  python_date_format: null
  extra:
    warning_markdown: null
version: 1.0.0
database_uuid: a7a3ee1d-801e-4e1b-bfe2-bff0a2d3b0a1
